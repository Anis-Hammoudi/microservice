<!--
  This HTML file provides the complete template for your HomeComponent.
  It's designed to be fully responsive and uses Tailwind CSS for styling.
  You can drop this file into your project, and it should work with your existing home.component.ts.
-->
<div class="bg-gray-50 min-h-screen font-sans">
  <!-- Header -->
  <header class="bg-white shadow-md sticky top-0 z-20">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <h1 class="text-2xl font-bold text-gray-800">FoodDash</h1>
        <button (click)="toggleCart()" class="relative rounded-full p-2 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
          </svg>
          <span *ngIf="cart.length > 0" class="absolute -top-1 -right-1 flex items-center justify-center h-5 w-5 bg-red-500 text-white text-xs font-bold rounded-full">
            {{ cart.length }}
          </span>
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">

    <!-- Category Filters -->
    <div class="mb-8">
      <h2 class="text-xl font-semibold text-gray-700 mb-4">Categories</h2>
      <div class="flex flex-wrap gap-2">
        <button
          (click)="filterByCategory('')"
          [class.bg-orange-600]="selectedCategory === ''"
          [class.text-white]="selectedCategory === ''"
          [class.bg-white]="selectedCategory !== ''"
          class="px-4 py-2 text-sm font-medium rounded-full shadow-sm hover:bg-orange-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition-colors duration-200">
          All
        </button>
        <!-- Loop through categories fetched from the backend -->
        <button
          *ngFor="let category of categories"
          (click)="filterByCategory(category)"
          [class.bg-orange-600]="selectedCategory === category"
          [class.text-white]="selectedCategory === category"
          [class.bg-white]="selectedCategory !== category"
          class="px-4 py-2 text-sm font-medium rounded-full shadow-sm hover:bg-orange-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition-colors duration-200">
          {{ category }}
        </button>
      </div>
    </div>

    <!-- Menu Items Grid -->
    <div>
      <h2 class="text-xl font-semibold text-gray-700 mb-4">Menu</h2>
      <!-- Check if there are menu items to display -->
      <div *ngIf="menuItems.length > 0; else noItems">
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          <!-- Loop through the menuItems array -->
          <div *ngFor="let item of menuItems" class="bg-white rounded-lg shadow-md overflow-hidden transform hover:-translate-y-1 transition-transform duration-300">
            <!-- FIX: Use $any() to bypass strict type checking for imageUrl -->
            <img [src]="$any(item).imageUrl || 'https://placehold.co/600x400/E2E8F0/A0AEC0?text=Food'" alt="{{ item.name }}" class="w-full h-48 object-cover">
            <div class="p-4">
              <h3 class="text-lg font-semibold text-gray-800">{{ item.name }}</h3>
              <p class="text-gray-500 text-sm mt-1">{{ item.description }}</p>
              <div class="flex items-center justify-between mt-4">
                <span class="text-xl font-bold text-gray-900">{{ item.price | currency:'EUR' }}</span>
                <button (click)="addToCart(item)" class="px-3 py-1.5 bg-orange-600 text-white text-sm font-semibold rounded-full hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500">
                  Add to Cart
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Template to show when menuItems array is empty -->
      <ng-template #noItems>
        <div class="text-center py-16 px-4">
          <p class="text-gray-500">No items found for the selected category.</p>
        </div>
      </ng-template>
    </div>

  </main>

  <!-- Shopping Cart Sidebar -->
  <div *ngIf="showCart" class="fixed inset-0 overflow-hidden z-30" aria-labelledby="slide-over-title" role="dialog" aria-modal="true">
    <div class="absolute inset-0 overflow-hidden">
      <!-- Background overlay -->
      <div class="absolute inset-0 bg-gray-500 bg-opacity-75 transition-opacity" (click)="toggleCart()"></div>

      <div class="fixed inset-y-0 right-0 pl-10 max-w-full flex">
        <div class="w-screen max-w-md">
          <div class="h-full flex flex-col bg-white shadow-xl overflow-y-scroll">
            <div class="flex-1 py-6 overflow-y-auto px-4 sm:px-6">
              <div class="flex items-start justify-between">
                <h2 class="text-lg font-medium text-gray-900" id="slide-over-title">Shopping Cart</h2>
                <div class="ml-3 h-7 flex items-center">
                  <button type="button" class="-m-2 p-2 text-gray-400 hover:text-gray-500" (click)="toggleCart()">
                    <span class="sr-only">Close panel</span>
                    <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                  </button>
                </div>
              </div>

              <div class="mt-8">
                <div class="flow-root">
                  <ul role="list" class="-my-6 divide-y divide-gray-200">
                    <!-- Loop through items in the cart -->
                    <li *ngFor="let item of cart; let i = index" class="py-6 flex">
                      <div class="h-24 w-24 flex-shrink-0 overflow-hidden rounded-md border border-gray-200">
                        <!-- FIX: Use $any() to bypass strict type checking for imageUrl -->
                        <img [src]="$any(item).imageUrl || 'https://placehold.co/200x200/E2E8F0/A0AEC0?text=Item'" alt="{{ item.name }}" class="h-full w-full object-cover object-center">
                      </div>
                      <div class="ml-4 flex-1 flex flex-col">
                        <div>
                          <div class="flex justify-between text-base font-medium text-gray-900">
                            <h3>{{ item.name }}</h3>
                            <p class="ml-4">{{ item.price * item.quantity | currency:'EUR' }}</p>
                          </div>
                        </div>
                        <div class="flex-1 flex items-end justify-between text-sm">
                          <div class="flex items-center">
                            <label for="quantity-{{i}}" class="sr-only">Quantity</label>
                            <input id="quantity-{{i}}" name="quantity-{{i}}" type="number" [ngModel]="item.quantity" (ngModelChange)="updateQuantity(i, $event)" min="1" class="w-16 text-center border-gray-300 rounded-md shadow-sm">
                          </div>
                          <div class="flex">
                            <button (click)="removeFromCart(i)" type="button" class="font-medium text-orange-600 hover:text-orange-500">Remove</button>
                          </div>
                        </div>
                      </div>
                    </li>
                    <li *ngIf="cart.length === 0" class="text-center py-10">
                      <p class="text-gray-500">Your cart is empty.</p>
                    </li>
                  </ul>
                </div>
              </div>
            </div>

            <div *ngIf="cart.length > 0" class="border-t border-gray-200 py-6 px-4 sm:px-6">
              <div class="flex justify-between text-base font-medium text-gray-900">
                <p>Subtotal</p>
                <p>{{ getCartTotal() | currency:'EUR' }}</p>
              </div>
              <p class="mt-0.5 text-sm text-gray-500">Shipping and taxes calculated at checkout.</p>
              <div class="mt-6">
                <button (click)="placeOrder()" class="w-full flex justify-center items-center px-6 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-orange-600 hover:bg-orange-700">Place Order</button>
              </div>
            </div>

            <!-- Order Status Message -->
            <div *ngIf="orderStatus" class="p-4 m-4 text-center rounded-md" [ngClass]="{'bg-green-100 text-green-800': lastOrderId, 'bg-red-100 text-red-800': !lastOrderId}">
              {{ orderStatus }}
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>
